---
title: 2025-05-03-010_AppService_정상배포_도메인연결오류_조치요청서
date: 2025-05-03
category: cursor_request
tags: [배포, Azure, 웹앱, 오류해결]
---

## ✅ 요청 개요

- 현재 `taxcredit-visual` Azure App Service의 `/wwwroot` 경로에서는 앱 콘텐츠가 정상적으로 제공되고 있으나, 기본 도메인(`https://taxcredit-visual.azurewebsites.net`) 접속 시 **Application Error**가 발생 중임.
- 이는 **앱은 배포되었으나 실행되지 않는 상태**로 판단되며, App Service의 설정 또는 `web.config`의 문제 가능성이 높음.
- 또한 커서가 Node.js 기반 서버 실행(`node server.js`) 구조로 전환한 이후 다수의 오류가 발생했고, App Service 자체에서 컨테이너 기동 실패, 포트 문제, HTTP 5xx 오류 등이 관측됨.
- 현재 `/wwwroot` 내 리소스는 정상적으로 배포되어 있으며, 정적 SPA 구조로 복구하는 것이 가장 안정적인 해결책임.


## 🛠 요청 작업 항목

### 1. App Service 구성 점검 및 복구
- Azure Portal > App Service > 구성 > 일반 설정 진입
- 다음 항목 수정
  - 스택: **Node**
  - 버전: **Node 20 LTS**
  - 시작 명령: **빈칸 (비워둠)** ← `node server.js` 제거

### 2. web.config 확인 및 복구
- `build/web.config`가 다음 구조로 배포되어 있는지 점검:

```xml
<configuration>
  <system.webServer>
    <rewrite>
      <rules>
        <rule name="React Routes" stopProcessing="true">
          <match url=".*" />
          <conditions logicalGrouping="MatchAll">
            <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
            <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
          </conditions>
          <action type="Rewrite" url="/index.html" />
        </rule>
      </rules>
    </rewrite>
  </system.webServer>
</configuration>
```

- 이상이 있을 경우 위 내용을 기준으로 복원

### 3. Node.js 서버 구조 제거
- `/server.js`, `/serve.js`, `/startup.sh`, `/default.conf` 등 기존 서버 실행을 위한 파일 모두 삭제
- `package.json`의 `"main"`, `"start"` 필드 원상 복구 (`react-scripts build` 기반)
- `express` 등 의존성 제거

### 4. App Service 재시작
- 위 설정 적용 후 App Service 수동 재시작

### 5. 태그 백업
- 현재 복원된 상태를 `app-static-stable` 이라는 이름으로 Git 태그 생성 및 푸시
```bash
git tag app-static-stable
git push origin --tags
```

### 6. 상태 확인
- App 도메인(`https://taxcredit-visual.azurewebsites.net`) 정상 동작 여부 직접 확인
- Curl 등으로도 HTTP 응답 상태를 점검 (200인지 확인)


## 🧾 참고 사항
- 최근 커서가 자동 삽입한 Express 기반 구조 및 startup 설정은 Azure App Service (Linux 기반)와 충돌을 일으켜 컨테이너 실행 실패를 반복하고 있음
- 반면, 정적 SPA 빌드 결과를 `/wwwroot`에 배포했을 때는 정상적으로 Kudu 경로에서 실행됨
- 따라서 Node.js 앱이 아닌 SPA 웹앱으로서의 App Service 구성이 더 적절함


## ⏱ 우선순위
**매우 높음** – 현재 UI 수정 완료된 상태이며, GitHub Actions로 빌드 및 배포도 완료되었으나 접속 불가 상태가 지속됨. 빠른 복구 필요.
