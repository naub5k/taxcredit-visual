---
title: API 500 오류 구조 기반 재검토 요청
date: 2025-05-10
requester: 유비님
---

## 📌 요청 배경

현재 API 호출 시 500 오류가 발생했던 이슈는  
- Azure SQL Serverless의 **웨이크업 지연**  
- Static Web App의 **45초 제한**  
- Function App과 Static Web App 간 **리디렉션 구조**

이 세 가지가 복합적으로 작용했을 가능성이 있습니다.

하지만 지금까지 커서는 이 오류에 대한 **구조 기반의 분석** 없이  
구조 탐색 또는 구성 파일 위주로만 접근했습니다.

---

## ❗ 요청 의도

이번 요청은 단순히 오류 원인을 다시 찾자는 것이 아니라,  
**"현재 구조에서 500 오류가 발생한 맥락을 커서가 제대로 이해하고 있는가?"**를 검증하는 목적입니다.

---

## 🧠 커서가 이해해야 할 전제 구조

- `staticwebapp.config.json`에 API 요청은 외부 Function App으로 리디렉션 설정됨
- 실제 Azure Function URL 직접 호출은 성공했음
- React 앱 내부에서 fallback 로직이 동작 중이며, 이를 통해도 응답 성공 확인
- Static Web App에서 프록시 호출 시만 500 오류 발생
- Azure SQL Serverless DB가 **비활성 상태에서 깨어날 때 45초 이상 걸리는 경우가 있음**

---

## 🧭 요청 작업 흐름

1. **현재 구조에서 Static Web App → API 호출 경로 흐름을 명확히 설명**
   - 리디렉션 설정이 작동하는 과정 포함
   - 프론트엔드 → Static Web App → Function App → DB까지의 흐름

2. **500 오류 발생 조건 분석**
   - Static Web App의 프록시 제한
   - DB 웨이크업 시간
   - HTTP timeout 처리 구조

3. **현재 fallback 분기 방식이 유효한지 평가**
   - React 앱에서 `fetch` 호출 실패 시 직접 URL 분기 처리 방식의 유효성
   - 실제로 이 fallback이 성공한 사례를 기반으로 평가할 것

4. **이 구조에서 추가 개선이 필요한지 판단**
   - 구조적으로 API Management, Durable Functions 등의 도입이 필요하다고 판단되는지
   - 아니면 현 구조로도 충분한 대응이 가능한지

---

## 🎯 최종 요구

> "커서 너는 이 오류를, 지금의 구조에서  
> 왜 발생했고, 왜 해결되었으며,  
> 앞으로 발생하지 않으려면 어떤 구조여야 하는지를  
> 정확히 설명할 수 있는가?"

이것이 이번 요청의 본질입니다.
