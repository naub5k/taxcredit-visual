---
title: ReactAPI 강남구 조회 오류 점검 요청서
category: cursor_request
date: 2025-05-10
requester: 유비님
---

# 🐞 오류 상황 요약

- **문제 발생 경로**: [https://polite-desert-03a31df00.6.azurestaticapps.net/region-detail?sido=서울특별시&gugun=강남구](https://polite-desert-03a31df00.6.azurestaticapps.net/region-detail?sido=서울특별시&gugun=강남구)
- **현상**: "서울특별시 강남구"를 클릭했을 때 전체 사업장 데이터(20건)가 모두 출력됨

# 🔍 상세 설명

- URL 파라미터는 명확하게 `sido=서울특별시&gugun=강남구`로 전달됨
- 그러나 화면에는 특정 구군이 아닌 **전체 시도 내의 사업장 레코드**가 출력됨
- 이는 API 또는 클라이언트 측에서의 **필터링 로직이 완전히 무시된 상태**일 가능성이 높음

# 📌 요청 사항

1. `getSampleList` API에서 `sido`, `gugun` 파라미터가 서버로 전달되고 있는지 확인
2. SQL 쿼리에서 해당 파라미터를 기반으로 `WHERE` 절이 제대로 구성되고 있는지 점검
3. React의 fetch 처리 또는 useEffect 호출 타이밍에서 쿼리 적용이 누락된 부분이 있는지 확인

# 🧾 참고 사항

- 정상: 강남구 클릭 시 → 강남구에 속한 사업장만 출력
- 현재: 강남구 클릭 시 → 금천구 포함 **전체 사업장 20건** 출력됨
- 대표 사례: (주)헤럴드아카데미, 미카도스시금천롯데캐슬점 등 **타 구군 사업장도 노출됨**

---

# ✅ 해결 결과 (2025-05-13)

## 문제 원인
1. **API 함수 문제**: `getSampleList` API에서 매개변수 처리가 직접 문자열 연결로 구현되어 있어 SQL 인젝션 위험도 있었습니다.
2. **DB 유틸리티 미지원**: `db-utils.js` 파일이 매개변수화된 쿼리를 지원하지 않았습니다.
3. **프론트엔드 보호 로직 부재**: 백엔드에서 필터링이 실패할 경우 클라이언트에서 추가 필터링하는 보호 장치가 없었습니다.

## 수정 사항
1. **getSampleList API 수정**:
   - 문자열 연결 대신 매개변수화된 쿼리 사용
   - 로깅 개선으로 요청 파라미터와 쿼리 내용 추적 가능

2. **db-utils.js 기능 개선**:
   - 매개변수화된 쿼리 지원 추가
   - SQL 인젝션 방지 구현

3. **RegionDetailPage 보호 기능 추가**:
   - 응답 데이터 로깅으로 필터링 확인 가능
   - 클라이언트측에서 추가 필터링 로직 구현 (백엔드 필터링 실패 시 보호 기능)
   - 화면에 표시되는 데이터는 필터링된 데이터 사용

위 수정 사항을 적용한 결과, "서울특별시 강남구" 조회 시 강남구 데이터만 정확히 표시됩니다.

---

> 이 요청은 `my-app/cursor_requests/` 하위에 저장되어야 하며, 디렉토리 기준은 `D:/Projects/taxcredit_mobileapp/my-app` 입니다.
